TODO
node-exporter c prometheus с grafana работает на podman через proxy_pass в nginx


Как всё работает
1) Мы покупаем vps ручками или покупаем через terraform AlmaLinux 9.0
2) Мы записываем новый tls сертификат через certbot и переносим его в nginx/ssl
3) Мы в ansible/hosts вписываем наш ipv4
4) мы пишем ansible-playbook -i infrastructure/ansible/inventory/hosts.yaml infrastructure/ansible/playbook/build/master.yaml -e PROJECT_DIR=/home/laimick/Developing/develop/Lune.su/
Что проиходит:
Обновление системы и установка самого нового kernel
Установка и настройка всех систем безопастности
Копирование TLS сертификата в /home/lune/nginx/ssl
Копирование Docker-Compose
Запуск helper.sh
Тот в свою очередь проверяет, чтоб всё работало штатно и запускает сборку docker compose up --build -d
Поздравляю, сервер работает

Обновление:
у нас есть github actions в github то есть в worflows у нас будет pull request котоырй поступает, там он проверяет, работает ли он нормально локально типо ansible-playbook --check и т.п. так же с dockerfile только уже билдит их
После этого как изменение будет принято, он отправляется в main ветку и там уже проихсодит docker build images и отправляется в docker.hub
После данной процедуры у нас запускается ещё 1 workflows который подключается к lune.su по ssh который мы дадим в github и он запускает ansible скрипт по update он обновляет пакеты и после запускает helper.sh он же в свою очередь прекращает выполнение предыдущего контейнера и проверяет там обновления и заново запускает обновлённый контейнер через --build
